variables:
  SSH_USER: "vp-dbbackup"
  SSH_HOST: "10.94.61.126"
  SSH_PRIVATE_KEY: |
    -----BEGIN RSA PRIVATE KEY-----
    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
    -----END RSA PRIVATE KEY-----

stages:
  - deploy

deploy:
  stage: deploy
  before_script:
    - 'which ssh-agent || ( apt-get update -y && apt-get install openssh-client -y )'
    - eval $(ssh-agent -s)
    - echo "$SSH_PRIVATE_KEY" | tr -d '\r' | ssh-add -
    - mkdir -p ~/.ssh
    - chmod 700 ~/.ssh
    - echo -e "Host *\n\tStrictHostKeyChecking no\n\n" > ~/.ssh/config
  script:
    - ssh $SSH_USER@$SSH_HOST "cd /opt/lampp/htdocs/safekup && git pull origin main && sudo /opt/lampp/lampp restart"
  only:
    - main
